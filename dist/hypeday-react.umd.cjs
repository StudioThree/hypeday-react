(function(d,w){typeof exports=="object"&&typeof module<"u"?module.exports=w(require("react")):typeof define=="function"&&define.amd?define(["react"],w):(d=typeof globalThis<"u"?globalThis:d||self,d.HypeDayReact=w(d.React))})(this,function(d){"use strict";const n=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(d);function A({title:e,rightText:s,buttonDisabled:i=!1,onClick:t,info:r,isLoading:l=!1}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},e),s?n.default.createElement("span",{className:"hypeday-info"},s):n.default.createElement("button",{className:"hypeday-button",onClick:t,disabled:l||i,title:i?"Please login first":void 0},l&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:l?"hidden":"initial"}},"Connect"))),r.map((f,a)=>n.default.createElement("span",{key:a,className:"hypeday-info"},f)))}function F({projectData:e,appId:s,userId:i}){var h,c,o;if(!((h=e==null?void 0:e.discord)!=null&&h.enabled)&&!((c=e==null?void 0:e.discord2)!=null&&c.enabled))return null;const{discord:t,discord2:r,userInfo:l}=e,f=[];t!=null&&t.enabled&&f.push(t),r!=null&&r.enabled&&f.push(r);const a=[];f.forEach(u=>{var g;if(u.isServerRequired){const y=n.default.createElement(n.default.Fragment,null,"Join the"," ",n.default.createElement("a",{href:u==null?void 0:u.serverLink,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,u==null?void 0:u.serverDisplayName))," ","server on Discord",u.isShouldJoinBeforeRequired?n.default.createElement(n.default.Fragment,null," ","before"," ",n.default.createElement("strong",null,new Date((u==null?void 0:u.shouldJoinBefore)||"").toLocaleString())):null);a.push(y)}if(u.isRoleRequired){const y=n.default.createElement(n.default.Fragment,null,'and have the "',(g=u==null?void 0:u.roleDisplayNames)==null?void 0:g.join(", "),'" role(s)');a.push(y)}});const m=()=>{console.log(s),alert("This is going to redirect user to Discord")};return n.default.createElement(A,{title:"Discord",onClick:m,info:a,rightText:(o=l==null?void 0:l.discord)==null?void 0:o.username,buttonDisabled:!i})}function k({projectData:e}){var i;if(!((i=e==null?void 0:e.customfield)!=null&&i.enabled))return null;const{customfield:s}=e;return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},"Open Response")),n.default.createElement("span",{className:"hypeday-info"},s.labels[0]),n.default.createElement("input",{className:"hypeday-input",type:"text",placeholder:s.labels[0]}))}function q({dateString:e,message:s}){const[i,t]=d.useState(!1),[r,l]=d.useState(0),[f,a]=d.useState(0),[m,h]=d.useState(0),[c,o]=d.useState(0);return d.useEffect(()=>{const u=new Date(e).getTime(),g=setInterval(()=>{const y=new Date().getTime(),E=u-y,R=Math.floor(E/(1e3*60*60*24)),S=Math.floor(E%(1e3*60*60*24)/(1e3*60*60)),b=Math.floor(E%(1e3*60*60)/(1e3*60)),N=Math.floor(E%(1e3*60)/1e3);if(E<=0){clearInterval(g),t(!0),l(0),a(0),h(0),o(0);return}l(R),a(S),h(b),o(N)},1e3);return()=>clearInterval(g)},[e]),!i&&!r&&!f&&!m&&!c?n.default.createElement("span",{style:{visibility:"hidden"}},"Calculating.."):i?n.default.createElement(n.default.Fragment,null,s):n.default.createElement(n.default.Fragment,null,r>0&&`${r} days, `,f>0&&`${f} hours, `,m>0&&`${m} minutes, `,c>0&&`${c} seconds`)}function T({children:e,title:s}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},s)),n.default.createElement("span",{className:"hypeday-info"},e))}function C({projectData:e}){var r,l,f,a,m,h,c,o,u,g,y,E;const[s,i]=d.useState(),t=((r=e==null?void 0:e.signupAccess)==null?void 0:r.isEndDateRequired)&&((l=e==null?void 0:e.signupAccess)==null?void 0:l.endDate)&&new Date((f=e==null?void 0:e.signupAccess)==null?void 0:f.endDate).getTime()<Date.now();return d.useEffect(()=>{var R,S,b,N;(R=e==null?void 0:e.signupAccess)!=null&&R.isStartDateRequired&&i(!!(((S=e==null?void 0:e.signupAccess)==null?void 0:S.isStartDateRequired)&&((b=e==null?void 0:e.signupAccess)==null?void 0:b.startDate)&&new Date((N=e==null?void 0:e.signupAccess)==null?void 0:N.startDate).getTime()>Date.now()))},[e]),d.useEffect(()=>{var R,S;if(s&&((R=e==null?void 0:e.signupAccess)==null?void 0:R.startDate)){const b=setTimeout(()=>i(!1),new Date((S=e==null?void 0:e.signupAccess)==null?void 0:S.startDate).getTime()-Date.now());return()=>clearTimeout(b)}},[s,(a=e==null?void 0:e.signupAccess)==null?void 0:a.startDate]),t&&((m=e.signupAccess)==null?void 0:m.endDate)?n.default.createElement(T,{title:"Registration is closed"},"Registration is closed on"," ",(c=new Date((h=e.signupAccess)==null?void 0:h.endDate))==null?void 0:c.toUTCString(),". Thank you for your interest."):s&&((o=e==null?void 0:e.signupAccess)==null?void 0:o.startDate)?n.default.createElement(T,{title:"Registration starts in:"},n.default.createElement(q,{dateString:(u=e==null?void 0:e.signupAccess)==null?void 0:u.startDate,message:"Registration is open."})):!t&&!s&&((g=e==null?void 0:e.signupAccess)==null?void 0:g.isEndDateRequired)&&((y=e==null?void 0:e.signupAccess)==null?void 0:y.endDate)?n.default.createElement(T,{title:"Registration ends in:"},n.default.createElement(q,{dateString:(E=e==null?void 0:e.signupAccess)==null?void 0:E.endDate,message:"Registration is closed."})):null}const L="https://apitest.hype.day";function v(e){return e.text().then(s=>{const i=s&&JSON.parse(s);if(!e.ok){const t=i&&i.message||e.statusText;return Promise.reject(t)}return i})}function H({appId:e,projectId:s,userId:i}){const t={method:"GET",headers:{"Content-Type":"application/json"}};return fetch(`${L}/getProject?`+new URLSearchParams({appid:e,userid:i||"",projectid:s}),t).then(v)}function P({appId:e,projectId:s,userId:i,returnUrl:t}){const r={method:"GET",headers:{"Content-Type":"application/json"}};return fetch("https://us-central1-hype-testing.cloudfunctions.net/tGetUrlForApp?"+new URLSearchParams({appid:e,userid:i,projectid:s,returnurl:t}),r).then(v)}function _({projectData:e,appId:s,userId:i}){var h,c,o;const[t,r]=d.useState(!1);if(!((h=e==null?void 0:e.twitter)!=null&&h.enabled))return null;const{twitter:l,userInfo:f}=e,a=[];if(l!=null&&l.isAccountCreatedRequired){const u=n.default.createElement(n.default.Fragment,null,"Have an account created before"," ",n.default.createElement("strong",null,new Date((l==null?void 0:l.accountCreated)||"").toLocaleDateString()));a.push(u)}if(l!=null&&l.isFollowRequired){const u=(c=l==null?void 0:l.follow)==null?void 0:c.split(","),g=n.default.createElement(n.default.Fragment,null,"Follow these account(s):",n.default.createElement("ul",null,u==null?void 0:u.map(y=>n.default.createElement("li",{key:y},n.default.createElement("a",{href:`https://twitter.com/${y.trim()}`,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"@",y))))));a.push(g)}if(l!=null&&l.isMinFollowersRequired){const u=n.default.createElement(n.default.Fragment,null,"Have at least ",n.default.createElement("b",null,l.minFollowers," follower(s)"));a.push(u)}if(l!=null&&l.isRetweetRequired){const u=n.default.createElement(n.default.Fragment,null,"Retweet"," ",n.default.createElement("a",{href:l.retweetUrl,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"this tweet")));a.push(u)}const m=async()=>{if(!(!s||!i||!(e!=null&&e.id)))try{r(!0);const{url:u}=await P({appId:s,userId:i,projectId:e.id,returnUrl:window.location.href});window.location.assign(u)}catch(u){console.error(u)}finally{r(!1)}};return n.default.createElement(A,{title:"Twitter",onClick:m,info:a,rightText:(o=f==null?void 0:f.twitter)==null?void 0:o.username,buttonDisabled:!i,isLoading:t})}const U={ethereum:"ETH",solana:"SOL",polygon:"MATIC",avalanche:"AVAX",flow:"FLOW"};function x({projectData:e}){if(!(e!=null&&e.wallet))return null;const{wallet:s}=e,i=[];if(s!=null&&s.isBalanceRequired){const t=n.default.createElement(n.default.Fragment,null,"Have at least",n.default.createElement("strong",null," "+s.balance+" "+U[e.chain]+" "),"in your wallet");i.push(t)}if(s!=null&&s.isNftRequired){const{nftCollection:t}=s,r=n.default.createElement(n.default.Fragment,null,"Hold an NFT from"," ",n.default.createElement("strong",null,n.default.createElement("a",{href:t==null?void 0:t.url,target:"_blank",rel:"noreferrer"},t==null?void 0:t.name)));i.push(r)}return n.default.createElement(A,{title:"Wallet",onClick:()=>console.log("wallet button clicked"),info:i,rightText:" "})}const O="";function M({appId:e,projectId:s,userId:i}){var c;const[t,r]=d.useState(),[l,f]=d.useState(!0),[a,m]=d.useState(!1);d.useEffect(()=>{if(!s||!e){console.error("HypeDayReact: projectId and appId props are required.");return}H({appId:e,projectId:s,userId:i}).then(o=>r(o)).finally(()=>f(!1))},[e,s,i]);const h=()=>{var o;(o=t==null?void 0:t.userInfo)!=null&&o.registered||(m(!0),setTimeout(()=>m(!1),3e3),console.log("register button clicked"))};return l?n.default.createElement("div",{className:"hypeday-wrapper",style:{display:"flex",justifyContent:"center"}},n.default.createElement("div",{className:"hypeday-spinner"})):n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement(C,{projectData:t}),n.default.createElement(x,{projectData:t}),n.default.createElement(_,{projectData:t,appId:e,userId:i}),n.default.createElement(F,{projectData:t,appId:e,userId:i}),n.default.createElement(k,{projectData:t}),n.default.createElement("button",{className:"hypeday-register-button",onClick:h,disabled:a},a&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:a?"hidden":"initial"}},(c=t==null?void 0:t.userInfo)!=null&&c.registered?"Registered":"Register")))}return M});
