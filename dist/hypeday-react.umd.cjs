(function(a,w){typeof exports=="object"&&typeof module<"u"?module.exports=w(require("react")):typeof define=="function"&&define.amd?define(["react"],w):(a=typeof globalThis<"u"?globalThis:a||self,a.HypeDayReact=w(a.React))})(this,function(a){"use strict";const n=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(a);function A({title:e,rightText:s,buttonDisabled:r=!1,onClick:t,info:u,isLoading:l=!1}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},e),s?n.default.createElement("span",{className:"hypeday-info"},s):n.default.createElement("button",{className:"hypeday-button",onClick:t,disabled:l||r,title:r?"Please login first":void 0},l&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:l?"hidden":"initial"}},"Connect"))),u.map((d,c)=>n.default.createElement("span",{key:c,className:"hypeday-info"},d)))}function F({projectData:e,appId:s,userId:r}){var f,m,h;if(!((f=e==null?void 0:e.discord)!=null&&f.enabled)&&!((m=e==null?void 0:e.discord2)!=null&&m.enabled))return null;const{discord:t,discord2:u,userInfo:l}=e,d=[];t!=null&&t.enabled&&d.push(t),u!=null&&u.enabled&&d.push(u);const c=[];d.forEach(i=>{var g;if(i.isServerRequired){const o=n.default.createElement(n.default.Fragment,null,"Join the"," ",n.default.createElement("a",{href:i==null?void 0:i.serverLink,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,i==null?void 0:i.serverDisplayName))," ","server on Discord",i.isShouldJoinBeforeRequired?n.default.createElement(n.default.Fragment,null," ","before"," ",n.default.createElement("strong",null,new Date((i==null?void 0:i.shouldJoinBefore)||"").toLocaleString())):null);c.push(o)}if(i.isRoleRequired){const o=n.default.createElement(n.default.Fragment,null,'and have the "',(g=i==null?void 0:i.roleDisplayNames)==null?void 0:g.join(", "),'" role(s)');c.push(o)}});const y=()=>{console.log(s),alert("This is going to redirect user to Discord")};return n.default.createElement(A,{title:"Discord",onClick:y,info:c,rightText:(h=l==null?void 0:l.discord)==null?void 0:h.username,buttonDisabled:!r})}function k({projectData:e}){var r;if(!((r=e==null?void 0:e.customfield)!=null&&r.enabled))return null;const{customfield:s}=e;return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},"Open Response")),n.default.createElement("span",{className:"hypeday-info"},s.labels[0]),n.default.createElement("input",{className:"hypeday-input",type:"text",placeholder:s.labels[0]}))}function q({dateString:e,message:s}){const[r,t]=a.useState(!1),[u,l]=a.useState(0),[d,c]=a.useState(0),[y,f]=a.useState(0),[m,h]=a.useState(0);return a.useEffect(()=>{const i=new Date(e).getTime(),g=setInterval(()=>{const o=new Date().getTime(),E=i-o,R=Math.floor(E/(1e3*60*60*24)),S=Math.floor(E%(1e3*60*60*24)/(1e3*60*60)),b=Math.floor(E%(1e3*60*60)/(1e3*60)),N=Math.floor(E%(1e3*60)/1e3);if(E<=0){clearInterval(g),t(!0),l(0),c(0),f(0),h(0);return}l(R),c(S),f(b),h(N)},1e3);return()=>clearInterval(g)},[e]),!r&&!u&&!d&&!y&&!m?n.default.createElement("span",{style:{visibility:"hidden"}},"Calculating.."):r?n.default.createElement(n.default.Fragment,null,s):n.default.createElement(n.default.Fragment,null,u>0&&`${u} days, `,d>0&&`${d} hours, `,y>0&&`${y} minutes, `,m>0&&`${m} seconds`)}function T({children:e,title:s}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},s)),n.default.createElement("span",{className:"hypeday-info"},e))}function C({projectData:e}){var u,l,d,c,y,f,m,h,i,g,o,E;const[s,r]=a.useState(),t=((u=e==null?void 0:e.signupAccess)==null?void 0:u.isEndDateRequired)&&((l=e==null?void 0:e.signupAccess)==null?void 0:l.endDate)&&new Date((d=e==null?void 0:e.signupAccess)==null?void 0:d.endDate).getTime()<Date.now();return a.useEffect(()=>{var R,S,b,N;(R=e==null?void 0:e.signupAccess)!=null&&R.isStartDateRequired&&r(!!(((S=e==null?void 0:e.signupAccess)==null?void 0:S.isStartDateRequired)&&((b=e==null?void 0:e.signupAccess)==null?void 0:b.startDate)&&new Date((N=e==null?void 0:e.signupAccess)==null?void 0:N.startDate).getTime()>Date.now()))},[e]),a.useEffect(()=>{var R,S;if(s&&((R=e==null?void 0:e.signupAccess)==null?void 0:R.startDate)){const b=setTimeout(()=>r(!1),new Date((S=e==null?void 0:e.signupAccess)==null?void 0:S.startDate).getTime()-Date.now());return()=>clearTimeout(b)}},[s,(c=e==null?void 0:e.signupAccess)==null?void 0:c.startDate]),t&&((y=e.signupAccess)==null?void 0:y.endDate)?n.default.createElement(T,{title:"Registration is closed"},"Registration is closed on"," ",(m=new Date((f=e.signupAccess)==null?void 0:f.endDate))==null?void 0:m.toUTCString(),". Thank you for your interest."):s&&((h=e==null?void 0:e.signupAccess)==null?void 0:h.startDate)?n.default.createElement(T,{title:"Registration starts in:"},n.default.createElement(q,{dateString:(i=e==null?void 0:e.signupAccess)==null?void 0:i.startDate,message:"Registration is open."})):!t&&!s&&((g=e==null?void 0:e.signupAccess)==null?void 0:g.isEndDateRequired)&&((o=e==null?void 0:e.signupAccess)==null?void 0:o.endDate)?n.default.createElement(T,{title:"Registration ends in:"},n.default.createElement(q,{dateString:(E=e==null?void 0:e.signupAccess)==null?void 0:E.endDate,message:"Registration is closed."})):null}const H="https://apitest.hype.day";function v(e){return e.text().then(s=>{const r=s&&JSON.parse(s);if(!e.ok){const t=r&&r.message||e.statusText;return Promise.reject(t)}return r})}function L({appId:e,projectId:s,userId:r}){const t={method:"GET",headers:{"Content-Type":"application/json"}};return fetch(`${H}/getProject?`+new URLSearchParams({appid:e,userid:r||"",projectid:s}),t).then(v)}function P({appId:e,projectId:s,userId:r,returnUrl:t}){const u={method:"GET",headers:{"Content-Type":"application/json"}};return fetch("https://us-central1-hype-testing.cloudfunctions.net/tGetUrlForApp?"+new URLSearchParams({appid:e,userid:r,projectid:s,returnurl:t}),u).then(v)}function _({projectData:e,appId:s,userId:r}){var f,m,h;const[t,u]=a.useState(!1);if(!((f=e==null?void 0:e.twitter)!=null&&f.enabled))return null;const{twitter:l,userInfo:d}=e,c=[];if(l!=null&&l.isAccountCreatedRequired){const i=n.default.createElement(n.default.Fragment,null,"Have an account created before"," ",n.default.createElement("strong",null,new Date((l==null?void 0:l.accountCreated)||"").toLocaleDateString()));c.push(i)}if(l!=null&&l.isFollowRequired){const i=(m=l==null?void 0:l.follow)==null?void 0:m.split(","),g=n.default.createElement(n.default.Fragment,null,"Follow these account(s):",n.default.createElement("ul",null,i==null?void 0:i.map(o=>n.default.createElement("li",{key:o},n.default.createElement("a",{href:`https://twitter.com/${o.trim()}`,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"@",o))))));c.push(g)}if(l!=null&&l.isMinFollowersRequired){const i=n.default.createElement(n.default.Fragment,null,"Have at least ",n.default.createElement("b",null,l.minFollowers," follower(s)"));c.push(i)}if(l!=null&&l.isRetweetRequired){const i=n.default.createElement(n.default.Fragment,null,"Retweet"," ",n.default.createElement("a",{href:l.retweetUrl,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"this tweet")));c.push(i)}const y=async()=>{if(!(!s||!r||!(e!=null&&e.id)))try{u(!0);const{url:i}=await P({appId:s,userId:r,projectId:e.id,returnUrl:window.location.href});window.location.assign(i)}catch(i){console.error(i)}finally{u(!1)}};return n.default.createElement(A,{title:"Twitter",onClick:y,info:c,rightText:(h=d==null?void 0:d.twitter)==null?void 0:h.username,buttonDisabled:!r,isLoading:t})}const U={ethereum:"ETH",solana:"SOL",polygon:"MATIC",avalanche:"AVAX",flow:"FLOW"};function p({projectData:e}){if(!(e!=null&&e.wallet))return null;const{wallet:s}=e,r=[];if(s!=null&&s.isBalanceRequired){const t=n.default.createElement(n.default.Fragment,null,"Have at least",n.default.createElement("strong",null," "+s.balance+" "+U[e.chain]+" "),"in your wallet");r.push(t)}if(s!=null&&s.isNftRequired){const{nftCollection:t}=s,u=n.default.createElement(n.default.Fragment,null,"Hold an NFT from"," ",n.default.createElement("strong",null,n.default.createElement("a",{href:t==null?void 0:t.url,target:"_blank",rel:"noreferrer"},t==null?void 0:t.name)));r.push(u)}return n.default.createElement(A,{title:"Wallet",onClick:()=>console.log("wallet button clicked"),info:r,rightText:" "})}const M="";function x({appId:e,projectId:s,userId:r}){var g;const[t,u]=a.useState(),[l,d]=a.useState(!0),[c,y]=a.useState(!1),[f,m]=a.useState(!1),h=async()=>{if(!s||!e){console.error("HypeDayReact: projectId and appId props are required.");return}d(!0),y(!1),L({appId:e,projectId:s,userId:r}).then(o=>u(o)).catch(o=>{console.error("HypeDayReact: Error fetching project data",o),y(!0)}).finally(()=>d(!1))};a.useEffect(()=>{h()},[e,s,r]);const i=()=>{var o;(o=t==null?void 0:t.userInfo)!=null&&o.registered||(m(!0),setTimeout(()=>m(!1),3e3),console.log("register button clicked"))};return l?n.default.createElement("div",{className:"hypeday-wrapper",style:{display:"flex",justifyContent:"center"}},n.default.createElement("div",{className:"hypeday-spinner"})):c?n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement("span",{className:"hypeday-error"},"Something went wrong. Please check your connection."),n.default.createElement("button",{className:"hypeday-button",onClick:h},"Retry")):n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement(C,{projectData:t}),n.default.createElement(p,{projectData:t}),n.default.createElement(_,{projectData:t,appId:e,userId:r}),n.default.createElement(F,{projectData:t,appId:e,userId:r}),n.default.createElement(k,{projectData:t}),n.default.createElement("button",{className:"hypeday-register-button",onClick:i,disabled:f},f&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:f?"hidden":"initial"}},(g=t==null?void 0:t.userInfo)!=null&&g.registered?"Registered":"Register")))}return x});
