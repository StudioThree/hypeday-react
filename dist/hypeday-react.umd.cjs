(function(d,R){typeof exports=="object"&&typeof module<"u"?module.exports=R(require("react")):typeof define=="function"&&define.amd?define(["react"],R):(d=typeof globalThis<"u"?globalThis:d||self,d.HypeDayReact=R(d.React))})(this,function(d){"use strict";const n=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(d);function A({title:e,rightText:l,buttonDisabled:s=!1,onClick:u,info:i,isLoading:o=!1}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},e),l?n.default.createElement("span",{className:"hypeday-info"},l):n.default.createElement("button",{className:"hypeday-button",onClick:u,disabled:o||s,title:s?"Please login first":void 0},o&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:o?"hidden":"initial"}},"Connect"))),i.map((m,h)=>n.default.createElement("span",{key:h,className:"hypeday-info"},m)))}function F({projectData:e,appId:l,userId:s}){var o,m,h,y;const u=d.useMemo(()=>{var g,f;if(!((g=e==null?void 0:e.discord)!=null&&g.enabled)&&!((f=e==null?void 0:e.discord2)!=null&&f.enabled))return[];const{discord:c,discord2:t}=e,a=[];c!=null&&c.enabled&&a.push(c),t!=null&&t.enabled&&a.push(t);const b=[];return a.forEach(r=>{var E;if(r.isServerRequired){const w=n.default.createElement(n.default.Fragment,null,"Join the"," ",n.default.createElement("a",{href:r==null?void 0:r.serverLink,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,r==null?void 0:r.serverDisplayName))," ","server on Discord",r.isShouldJoinBeforeRequired?n.default.createElement(n.default.Fragment,null," ","before"," ",n.default.createElement("strong",null,new Date((r==null?void 0:r.shouldJoinBefore)||"").toLocaleString())):null);b.push(w)}if(r.isRoleRequired){const w=n.default.createElement(n.default.Fragment,null,'and have the "',(E=r==null?void 0:r.roleDisplayNames)==null?void 0:E.join(", "),'" role(s)');b.push(w)}}),b},[e]),i=()=>{console.log(l),alert("This is going to redirect user to Discord")};return!((o=e==null?void 0:e.discord)!=null&&o.enabled)&&!((m=e==null?void 0:e.discord2)!=null&&m.enabled)?null:n.default.createElement(A,{title:"Discord",onClick:i,info:u,rightText:(y=(h=e==null?void 0:e.userInfo)==null?void 0:h.discord)==null?void 0:y.username,buttonDisabled:!s})}function k({projectData:e}){var s;if(!((s=e==null?void 0:e.customfield)!=null&&s.enabled))return null;const{customfield:l}=e;return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},"Open Response")),n.default.createElement("span",{className:"hypeday-info"},l.labels[0]),n.default.createElement("input",{className:"hypeday-input",type:"text",placeholder:l.labels[0]}))}function q({dateString:e,message:l}){const[s,u]=d.useState(!1),[i,o]=d.useState(0),[m,h]=d.useState(0),[y,c]=d.useState(0),[t,a]=d.useState(0);return d.useEffect(()=>{const b=new Date(e).getTime(),g=setInterval(()=>{const f=new Date().getTime(),r=b-f,E=Math.floor(r/(1e3*60*60*24)),w=Math.floor(r%(1e3*60*60*24)/(1e3*60*60)),S=Math.floor(r%(1e3*60*60)/(1e3*60)),N=Math.floor(r%(1e3*60)/1e3);if(r<=0){clearInterval(g),u(!0),o(0),h(0),c(0),a(0);return}o(E),h(w),c(S),a(N)},1e3);return()=>clearInterval(g)},[e]),!s&&!i&&!m&&!y&&!t?n.default.createElement("span",{style:{visibility:"hidden"}},"Calculating.."):s?n.default.createElement(n.default.Fragment,null,l):n.default.createElement(n.default.Fragment,null,i>0&&`${i} days, `,m>0&&`${m} hours, `,y>0&&`${y} minutes, `,t>0&&`${t} seconds`)}function T({children:e,title:l}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},l)),n.default.createElement("span",{className:"hypeday-info"},e))}function C({projectData:e}){var i,o,m,h,y,c,t,a,b,g,f,r;const[l,s]=d.useState(),u=((i=e==null?void 0:e.signupAccess)==null?void 0:i.isEndDateRequired)&&((o=e==null?void 0:e.signupAccess)==null?void 0:o.endDate)&&new Date((m=e==null?void 0:e.signupAccess)==null?void 0:m.endDate).getTime()<Date.now();return d.useEffect(()=>{var E,w,S,N;(E=e==null?void 0:e.signupAccess)!=null&&E.isStartDateRequired&&s(!!(((w=e==null?void 0:e.signupAccess)==null?void 0:w.isStartDateRequired)&&((S=e==null?void 0:e.signupAccess)==null?void 0:S.startDate)&&new Date((N=e==null?void 0:e.signupAccess)==null?void 0:N.startDate).getTime()>Date.now()))},[e]),d.useEffect(()=>{var E,w;if(l&&((E=e==null?void 0:e.signupAccess)==null?void 0:E.startDate)){const S=setTimeout(()=>s(!1),new Date((w=e==null?void 0:e.signupAccess)==null?void 0:w.startDate).getTime()-Date.now());return()=>clearTimeout(S)}},[l,(h=e==null?void 0:e.signupAccess)==null?void 0:h.startDate]),u&&((y=e.signupAccess)==null?void 0:y.endDate)?n.default.createElement(T,{title:"Registration is closed"},"Registration is closed on"," ",(t=new Date((c=e.signupAccess)==null?void 0:c.endDate))==null?void 0:t.toUTCString(),". Thank you for your interest."):l&&((a=e==null?void 0:e.signupAccess)==null?void 0:a.startDate)?n.default.createElement(T,{title:"Registration starts in:"},n.default.createElement(q,{dateString:(b=e==null?void 0:e.signupAccess)==null?void 0:b.startDate,message:"Registration is open."})):!u&&!l&&((g=e==null?void 0:e.signupAccess)==null?void 0:g.isEndDateRequired)&&((f=e==null?void 0:e.signupAccess)==null?void 0:f.endDate)?n.default.createElement(T,{title:"Registration ends in:"},n.default.createElement(q,{dateString:(r=e==null?void 0:e.signupAccess)==null?void 0:r.endDate,message:"Registration is closed."})):null}const H="https://apitest.hype.day";function v(e){return e.text().then(l=>{const s=l&&JSON.parse(l);if(!e.ok){const u=s&&s.message||e.statusText;return Promise.reject(u)}return s})}function L({appId:e,projectId:l,userId:s}){const u={method:"GET",headers:{"Content-Type":"application/json"}};return fetch(`${H}/getProject?`+new URLSearchParams({appid:e,userid:s||"",projectid:l}),u).then(v)}function P({appId:e,projectId:l,userId:s,returnUrl:u}){const i={method:"GET",headers:{"Content-Type":"application/json"}};return fetch("https://us-central1-hype-testing.cloudfunctions.net/tGetUrlForApp?"+new URLSearchParams({appid:e,userid:s,projectid:l,returnurl:u}),i).then(v)}function M({projectData:e,appId:l,userId:s}){var h,y,c;const[u,i]=d.useState(!1),o=d.useMemo(()=>{var b,g;if(!((b=e==null?void 0:e.twitter)!=null&&b.enabled))return[];const{twitter:t}=e,a=[];if(t!=null&&t.isAccountCreatedRequired){const f=n.default.createElement(n.default.Fragment,null,"Have an account created before"," ",n.default.createElement("strong",null,new Date((t==null?void 0:t.accountCreated)||"").toLocaleDateString()));a.push(f)}if(t!=null&&t.isFollowRequired){const f=(g=t==null?void 0:t.follow)==null?void 0:g.split(","),r=n.default.createElement(n.default.Fragment,null,"Follow these account(s):",n.default.createElement("ul",null,f==null?void 0:f.map(E=>n.default.createElement("li",{key:E},n.default.createElement("a",{href:`https://twitter.com/${E.trim()}`,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"@",E))))));a.push(r)}if(t!=null&&t.isMinFollowersRequired){const f=n.default.createElement(n.default.Fragment,null,"Have at least ",n.default.createElement("b",null,t.minFollowers," follower(s)"));a.push(f)}if(t!=null&&t.isRetweetRequired){const f=n.default.createElement(n.default.Fragment,null,"Retweet"," ",n.default.createElement("a",{href:t.retweetUrl,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"this tweet")));a.push(f)}return a},[e]),m=async()=>{if(!(!l||!s||!(e!=null&&e.id)))try{i(!0);const{url:t}=await P({appId:l,userId:s,projectId:e.id,returnUrl:window.location.href});window.location.assign(t)}catch(t){console.error(t)}finally{i(!1)}};return(h=e==null?void 0:e.twitter)!=null&&h.enabled?n.default.createElement(A,{title:"Twitter",onClick:m,info:o,rightText:(c=(y=e==null?void 0:e.userInfo)==null?void 0:y.twitter)==null?void 0:c.username,buttonDisabled:!s,isLoading:u}):null}const _={ethereum:"ETH",solana:"SOL",polygon:"MATIC",avalanche:"AVAX",flow:"FLOW"};function U({projectData:e}){const l=d.useMemo(()=>{if(!(e!=null&&e.wallet))return[];const{wallet:s}=e,u=[];if(s!=null&&s.isBalanceRequired){const i=n.default.createElement(n.default.Fragment,null,"Have at least",n.default.createElement("strong",null," "+s.balance+" "+_[e.chain]+" "),"in your wallet");u.push(i)}if(s!=null&&s.isNftRequired){const{nftCollection:i}=s,o=n.default.createElement(n.default.Fragment,null,"Hold an NFT from"," ",n.default.createElement("strong",null,n.default.createElement("a",{href:i==null?void 0:i.url,target:"_blank",rel:"noreferrer"},i==null?void 0:i.name)));u.push(o)}return u},[e]);return e!=null&&e.wallet?n.default.createElement(A,{title:"Wallet",onClick:()=>console.log("wallet button clicked"),info:l,rightText:" "}):null}const O="";function x({appId:e,projectId:l,userId:s}){var g;const[u,i]=d.useState(),[o,m]=d.useState(!0),[h,y]=d.useState(!1),[c,t]=d.useState(!1),a=d.useCallback(async()=>{if(!l||!e){console.error("HypeDayReact: projectId and appId props are required.");return}m(!0),y(!1),L({appId:e,projectId:l,userId:s}).then(f=>i(f)).catch(f=>{console.error("HypeDayReact: Error fetching project data",f),y(!0)}).finally(()=>m(!1))},[e,l,s]);d.useEffect(()=>{a()},[a]);const b=()=>{var f;(f=u==null?void 0:u.userInfo)!=null&&f.registered||(t(!0),setTimeout(()=>t(!1),3e3),console.log("register button clicked"))};return o?n.default.createElement("div",{className:"hypeday-wrapper",style:{display:"flex",justifyContent:"center"}},n.default.createElement("div",{className:"hypeday-spinner"})):h?n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement("span",{className:"hypeday-error"},"Something went wrong. Please check your connection."),n.default.createElement("button",{className:"hypeday-button",onClick:a},"Retry")):n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement(C,{projectData:u}),n.default.createElement(U,{projectData:u}),n.default.createElement(M,{projectData:u,appId:e,userId:s}),n.default.createElement(F,{projectData:u,appId:e,userId:s}),n.default.createElement(k,{projectData:u}),n.default.createElement("button",{className:"hypeday-register-button",onClick:b,disabled:c},c&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:c?"hidden":"initial"}},(g=u==null?void 0:u.userInfo)!=null&&g.registered?"Registered":"Register")))}return x});
