(function(r,v){typeof exports=="object"&&typeof module<"u"?module.exports=v(require("react")):typeof define=="function"&&define.amd?define(["react"],v):(r=typeof globalThis<"u"?globalThis:r||self,r.HypeDayReact=v(r.React))})(this,function(r){"use strict";const n=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(r),q="https://apitest.hype.day";function T(e){return e.text().then(t=>{const s=t&&JSON.parse(t);if(!e.ok){const i=s&&s.message||e.statusText;return Promise.reject(i)}return s})}function P({appId:e,projectId:t,walletAddress:s}){const i={method:"GET",headers:{"Content-Type":"application/json"}};return fetch(`${q}/getProject?`+new URLSearchParams({appid:e,wallet:s||"",projectid:t}),i).then(T)}function C({provider:e,appId:t,projectId:s,chain:i,walletAddress:u,returnUrl:o}){const c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appId:t,chain:i,walletAddress:u,projectId:s,returnUrl:o})};return fetch(`${q}/${e==="twitter"?"t":"d"}GetUrlForApp`,c).then(T)}function H({appId:e,projectId:t,chain:s,wallet:i,customField:u}){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appId:e,chain:s,wallet:i,projectId:t,customField:u})};return fetch(`${q}/validateForAppProject`,o).then(T)}function F({title:e,rightText:t,buttonDisabled:s=!1,onClick:i,info:u,isLoading:o=!1}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},e),t?n.default.createElement("span",{className:"hypeday-info"},t):n.default.createElement("button",{className:"hypeday-button",onClick:i,disabled:o||s,title:s?"Please login first":void 0},o&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:o?"hidden":"initial"}},"Connect"))),u.map((c,h)=>n.default.createElement("span",{key:h,className:"hypeday-info"},c)))}function M({projectData:e,appId:t,walletAddress:s}){var h,y,g,l;const[i,u]=r.useState(!1),o=r.useMemo(()=>{var E,a;if(!((E=e==null?void 0:e.discord)!=null&&E.enabled)&&!((a=e==null?void 0:e.discord2)!=null&&a.enabled))return[];const{discord:d,discord2:b}=e,S=[];d!=null&&d.enabled&&S.push(d),b!=null&&b.enabled&&S.push(b);const m=[];return S.forEach(f=>{var w;if(f.isServerRequired){const N=n.default.createElement(n.default.Fragment,null,"Join the"," ",n.default.createElement("a",{href:f==null?void 0:f.serverLink,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,f==null?void 0:f.serverDisplayName))," ","server on Discord",f.isShouldJoinBeforeRequired?n.default.createElement(n.default.Fragment,null," ","before"," ",n.default.createElement("strong",null,new Date((f==null?void 0:f.shouldJoinBefore)||"").toLocaleString())):null);m.push(N)}if(f.isRoleRequired){const N=n.default.createElement(n.default.Fragment,null,'and have the "',(w=f==null?void 0:f.roleDisplayNames)==null?void 0:w.join(", "),'" role(s)');m.push(N)}}),m},[e]),c=async()=>{if(!(!t||!s||!(e!=null&&e.id)))try{u(!0);const{url:d}=await C({provider:"discord",appId:t,walletAddress:s,chain:e.chain,projectId:e.id,returnUrl:window.location.href});window.location.assign(d)}catch(d){console.error(d)}finally{u(!1)}};return!((h=e==null?void 0:e.discord)!=null&&h.enabled)&&!((y=e==null?void 0:e.discord2)!=null&&y.enabled)?null:n.default.createElement(F,{title:"Discord",onClick:c,info:o,rightText:(l=(g=e==null?void 0:e.userInfo)==null?void 0:g.discord)==null?void 0:l.username,buttonDisabled:!s,isLoading:i})}const _=n.default.forwardRef(function({projectData:t},s){var u;if(!((u=t==null?void 0:t.customfield)!=null&&u.enabled))return null;const{customfield:i}=t;return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},"Open Response")),n.default.createElement("span",{className:"hypeday-info"},i.labels[0]),n.default.createElement("input",{className:"hypeday-input",type:"text",placeholder:i.labels[0],ref:s}))});function k({dateString:e,message:t}){const[s,i]=r.useState(!1),[u,o]=r.useState(0),[c,h]=r.useState(0),[y,g]=r.useState(0),[l,d]=r.useState(0);return r.useEffect(()=>{const b=new Date(e).getTime(),S=setInterval(()=>{const m=new Date().getTime(),E=b-m,a=Math.floor(E/(1e3*60*60*24)),f=Math.floor(E%(1e3*60*60*24)/(1e3*60*60)),w=Math.floor(E%(1e3*60*60)/(1e3*60)),N=Math.floor(E%(1e3*60)/1e3);if(E<=0){clearInterval(S),i(!0),o(0),h(0),g(0),d(0);return}o(a),h(f),g(w),d(N)},1e3);return()=>clearInterval(S)},[e]),!s&&!u&&!c&&!y&&!l?n.default.createElement("span",{style:{visibility:"hidden"}},"Calculating.."):s?n.default.createElement(n.default.Fragment,null,t):n.default.createElement(n.default.Fragment,null,u>0&&`${u} days, `,c>0&&`${c} hours, `,y>0&&`${y} minutes, `,l>0&&`${l} seconds`)}function A({children:e,title:t}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},t)),n.default.createElement("span",{className:"hypeday-info"},e))}function $({projectData:e}){var u,o,c,h,y,g,l,d,b,S,m,E;const[t,s]=r.useState(),i=((u=e==null?void 0:e.signupAccess)==null?void 0:u.isEndDateRequired)&&((o=e==null?void 0:e.signupAccess)==null?void 0:o.endDate)&&new Date((c=e==null?void 0:e.signupAccess)==null?void 0:c.endDate).getTime()<Date.now();return r.useEffect(()=>{var a,f,w,N;(a=e==null?void 0:e.signupAccess)!=null&&a.isStartDateRequired&&s(!!(((f=e==null?void 0:e.signupAccess)==null?void 0:f.isStartDateRequired)&&((w=e==null?void 0:e.signupAccess)==null?void 0:w.startDate)&&new Date((N=e==null?void 0:e.signupAccess)==null?void 0:N.startDate).getTime()>Date.now()))},[e]),r.useEffect(()=>{var a,f;if(t&&((a=e==null?void 0:e.signupAccess)==null?void 0:a.startDate)){const w=setTimeout(()=>s(!1),new Date((f=e==null?void 0:e.signupAccess)==null?void 0:f.startDate).getTime()-Date.now());return()=>clearTimeout(w)}},[t,(h=e==null?void 0:e.signupAccess)==null?void 0:h.startDate]),i&&((y=e.signupAccess)==null?void 0:y.endDate)?n.default.createElement(A,{title:"Registration is closed"},"Registration is closed on"," ",(l=new Date((g=e.signupAccess)==null?void 0:g.endDate))==null?void 0:l.toUTCString(),". Thank you for your interest."):t&&((d=e==null?void 0:e.signupAccess)==null?void 0:d.startDate)?n.default.createElement(A,{title:"Registration starts in:"},n.default.createElement(k,{dateString:(b=e==null?void 0:e.signupAccess)==null?void 0:b.startDate,message:"Registration is open."})):!i&&!t&&((S=e==null?void 0:e.signupAccess)==null?void 0:S.isEndDateRequired)&&((m=e==null?void 0:e.signupAccess)==null?void 0:m.endDate)?n.default.createElement(A,{title:"Registration ends in:"},n.default.createElement(k,{dateString:(E=e==null?void 0:e.signupAccess)==null?void 0:E.endDate,message:"Registration is closed."})):null}function U({projectData:e,appId:t,walletAddress:s}){var h,y,g;const[i,u]=r.useState(!1),o=r.useMemo(()=>{var b,S;if(!((b=e==null?void 0:e.twitter)!=null&&b.enabled))return[];const{twitter:l}=e,d=[];if(l!=null&&l.isAccountCreatedRequired){const m=n.default.createElement(n.default.Fragment,null,"Have an account created before"," ",n.default.createElement("strong",null,new Date((l==null?void 0:l.accountCreated)||"").toLocaleDateString()));d.push(m)}if(l!=null&&l.isFollowRequired){const m=(S=l==null?void 0:l.follow)==null?void 0:S.split(","),E=n.default.createElement(n.default.Fragment,null,"Follow these account(s):",n.default.createElement("ul",null,m==null?void 0:m.map(a=>n.default.createElement("li",{key:a},n.default.createElement("a",{href:`https://twitter.com/${a.trim()}`,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"@",a))))));d.push(E)}if(l!=null&&l.isMinFollowersRequired){const m=n.default.createElement(n.default.Fragment,null,"Have at least ",n.default.createElement("b",null,l.minFollowers," follower(s)"));d.push(m)}if(l!=null&&l.isRetweetRequired){const m=n.default.createElement(n.default.Fragment,null,"Retweet"," ",n.default.createElement("a",{href:l.retweetUrl,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"this tweet")));d.push(m)}return d},[e]),c=async()=>{if(!(!t||!s||!(e!=null&&e.id)))try{u(!0);const{url:l}=await C({provider:"twitter",appId:t,walletAddress:s,chain:e.chain,projectId:e.id,returnUrl:window.location.href});window.location.assign(l)}catch(l){console.error(l)}finally{u(!1)}};return(h=e==null?void 0:e.twitter)!=null&&h.enabled?n.default.createElement(F,{title:"Twitter",onClick:c,info:o,rightText:(g=(y=e==null?void 0:e.userInfo)==null?void 0:y.twitter)==null?void 0:g.username,buttonDisabled:!s,isLoading:i}):null}const x={ethereum:"ETH",solana:"SOL",polygon:"MATIC",avalanche:"AVAX",flow:"FLOW"};function B({projectData:e}){const t=r.useMemo(()=>{if(!(e!=null&&e.wallet))return[];const{wallet:s}=e,i=[];if(s!=null&&s.isBalanceRequired){const u=n.default.createElement(n.default.Fragment,null,"Have at least",n.default.createElement("strong",null," "+s.balance+" "+x[e.chain]+" "),"in your wallet");i.push(u)}if(s!=null&&s.isNftRequired){const{nftCollection:u}=s,o=n.default.createElement(n.default.Fragment,null,"Hold an NFT from"," ",n.default.createElement("strong",null,n.default.createElement("a",{href:u==null?void 0:u.url,target:"_blank",rel:"noreferrer"},u==null?void 0:u.name)));i.push(o)}return i},[e]);return e!=null&&e.wallet?n.default.createElement(F,{title:"Wallet",onClick:()=>console.log("wallet button clicked"),info:t,rightText:" "}):null}const G="";function J({projectData:e,appId:t,walletAddress:s,inputRef:i}){var l,d,b,S,m,E,a,f,w,N,L;const[u,o]=r.useState(!1),[c,h]=r.useState(""),y=async()=>{var O,I;if(!(!t||!s||!(e!=null&&e.id)||((O=e==null?void 0:e.userInfo)==null?void 0:O.registered)))try{h(""),o(!0);const{error:R}=await H({appId:t,wallet:s,chain:e.chain,projectId:e.id,customField:((I=i==null?void 0:i.current)==null?void 0:I.value)||""});console.error("Register error",R),h(R.message)}catch(R){console.error(R)}finally{o(!1)}},g=u||!s||((l=e==null?void 0:e.userInfo)==null?void 0:l.registered)||((d=e==null?void 0:e.discord)==null?void 0:d.enabled)&&!((S=(b=e==null?void 0:e.userInfo)==null?void 0:b.discord)!=null&&S.username)||((m=e==null?void 0:e.discord2)==null?void 0:m.enabled)&&!((a=(E=e==null?void 0:e.userInfo)==null?void 0:E.discord)!=null&&a.username)||((f=e==null?void 0:e.twitter)==null?void 0:f.enabled)&&!((N=(w=e==null?void 0:e.userInfo)==null?void 0:w.twitter)!=null&&N.username);return n.default.createElement(n.default.Fragment,null,n.default.createElement("button",{className:"hypeday-register-button",onClick:y,disabled:g},u&&n.default.createElement("div",{className:"hypeday-spinner hypeday-btn-spinner"}),n.default.createElement("span",{style:{visibility:u?"hidden":"initial"}},(L=e==null?void 0:e.userInfo)!=null&&L.registered?"Registered":"Register")),!!c&&n.default.createElement("span",{className:"hypeday-register-error"},c))}function W({appId:e,projectId:t,walletAddress:s}){const[i,u]=r.useState(),[o,c]=r.useState(!0),[h,y]=r.useState(!1),g=r.useRef(null),l=r.useCallback(async()=>{if(!t||!e){console.error("HypeDayReact: projectId and appId props are required.");return}c(!0),y(!1),P({appId:e,projectId:t,walletAddress:s}).then(d=>u(d)).catch(d=>{console.error("HypeDayReact: Error fetching project data",d),y(!0)}).finally(()=>c(!1))},[e,t,s]);return r.useEffect(()=>{l()},[l]),o?n.default.createElement("div",{className:"hypeday-wrapper",style:{display:"flex",justifyContent:"center"}},n.default.createElement("div",{className:"hypeday-spinner"})):h?n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement("span",{className:"hypeday-error"},"Something went wrong. Please check your connection."),n.default.createElement("button",{className:"hypeday-button",onClick:l},"Retry")):n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement($,{projectData:i}),n.default.createElement(B,{projectData:i}),n.default.createElement(U,{projectData:i,appId:e,walletAddress:s}),n.default.createElement(M,{projectData:i,appId:e,walletAddress:s}),n.default.createElement(_,{projectData:i,ref:g}),n.default.createElement(J,{projectData:i,appId:e,walletAddress:s,inputRef:g}))}return W});
