(function(a,b){typeof exports=="object"&&typeof module<"u"?module.exports=b(require("react")):typeof define=="function"&&define.amd?define(["react"],b):(a=typeof globalThis<"u"?globalThis:a||self,a.HypeDayReact=b(a.React))})(this,function(a){"use strict";const n=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(a);function T({title:e,rightText:s,buttonDisabled:l=!1,onClick:t,info:i}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},e),s?n.default.createElement("span",{className:"hypeday-info"},s):n.default.createElement("button",{className:"hypeday-button",onClick:t,disabled:l,title:l?"Please login first":void 0},"Connect")),i.map((d,o)=>n.default.createElement("span",{key:o,className:"hypeday-info"},d)))}function v({projectData:e,appId:s,userId:l}){var m,r,h;if(!((m=e==null?void 0:e.discord)!=null&&m.enabled)&&!((r=e==null?void 0:e.discord2)!=null&&r.enabled))return null;const{discord:t,discord2:i,userInfo:d}=e,o=[];t!=null&&t.enabled&&o.push(t),i!=null&&i.enabled&&o.push(i);const c=[];o.forEach(u=>{var g;if(u.isServerRequired){const y=n.default.createElement(n.default.Fragment,null,"Join the"," ",n.default.createElement("a",{href:u==null?void 0:u.serverLink,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,u==null?void 0:u.serverDisplayName))," ","server on Discord",u.isShouldJoinBeforeRequired?n.default.createElement(n.default.Fragment,null," ","before"," ",n.default.createElement("strong",null,new Date((u==null?void 0:u.shouldJoinBefore)||"").toLocaleString())):null);c.push(y)}if(u.isRoleRequired){const y=n.default.createElement(n.default.Fragment,null,'and have the "',(g=u==null?void 0:u.roleDisplayNames)==null?void 0:g.join(", "),'" role(s)');c.push(y)}});const f=()=>{console.log(s),alert("This is going to redirect user to Discord")};return n.default.createElement(T,{title:"Discord",onClick:f,info:c,rightText:(h=d==null?void 0:d.discord)==null?void 0:h.username,buttonDisabled:!l})}function k({projectData:e}){var l;if(!((l=e==null?void 0:e.customfield)!=null&&l.enabled))return null;const{customfield:s}=e;return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},"Open Response")),n.default.createElement("span",{className:"hypeday-info"},s.labels[0]),n.default.createElement("input",{className:"hypeday-input",type:"text",placeholder:s.labels[0]}))}function N({dateString:e,message:s}){const[l,t]=a.useState(!1),[i,d]=a.useState(0),[o,c]=a.useState(0),[f,m]=a.useState(0),[r,h]=a.useState(0);return a.useEffect(()=>{const u=new Date(e).getTime(),g=setInterval(()=>{const y=new Date().getTime(),E=u-y,R=Math.floor(E/(1e3*60*60*24)),S=Math.floor(E%(1e3*60*60*24)/(1e3*60*60)),w=Math.floor(E%(1e3*60*60)/(1e3*60)),A=Math.floor(E%(1e3*60)/1e3);if(E<=0){clearInterval(g),t(!0),d(0),c(0),m(0),h(0);return}d(R),c(S),m(w),h(A)},1e3);return()=>clearInterval(g)},[e]),!l&&!i&&!o&&!f&&!r?n.default.createElement("span",{style:{visibility:"hidden"}},"Calculating.."):l?n.default.createElement(n.default.Fragment,null,s):n.default.createElement(n.default.Fragment,null,i>0&&`${i} days, `,o>0&&`${o} hours, `,f>0&&`${f} minutes, `,r>0&&`${r} seconds`)}function q({children:e,title:s}){return n.default.createElement("section",{className:"hypeday-section"},n.default.createElement("header",{className:"hypeday-section-header"},n.default.createElement("h3",{className:"hypeday-h3"},s)),n.default.createElement("span",{className:"hypeday-info"},e))}function C({projectData:e}){var i,d,o,c,f,m,r,h,u,g,y,E;const[s,l]=a.useState(),t=((i=e==null?void 0:e.signupAccess)==null?void 0:i.isEndDateRequired)&&((d=e==null?void 0:e.signupAccess)==null?void 0:d.endDate)&&new Date((o=e==null?void 0:e.signupAccess)==null?void 0:o.endDate).getTime()<Date.now();return a.useEffect(()=>{var R,S,w,A;(R=e==null?void 0:e.signupAccess)!=null&&R.isStartDateRequired&&l(!!(((S=e==null?void 0:e.signupAccess)==null?void 0:S.isStartDateRequired)&&((w=e==null?void 0:e.signupAccess)==null?void 0:w.startDate)&&new Date((A=e==null?void 0:e.signupAccess)==null?void 0:A.startDate).getTime()>Date.now()))},[e]),a.useEffect(()=>{var R,S;if(s&&((R=e==null?void 0:e.signupAccess)==null?void 0:R.startDate)){const w=setTimeout(()=>l(!1),new Date((S=e==null?void 0:e.signupAccess)==null?void 0:S.startDate).getTime()-Date.now());return()=>clearTimeout(w)}},[s,(c=e==null?void 0:e.signupAccess)==null?void 0:c.startDate]),t&&((f=e.signupAccess)==null?void 0:f.endDate)?n.default.createElement(q,{title:"Registration is closed"},"Registration is closed on"," ",(r=new Date((m=e.signupAccess)==null?void 0:m.endDate))==null?void 0:r.toUTCString(),". Thank you for your interest."):s&&((h=e==null?void 0:e.signupAccess)==null?void 0:h.startDate)?n.default.createElement(q,{title:"Registration starts in:"},n.default.createElement(N,{dateString:(u=e==null?void 0:e.signupAccess)==null?void 0:u.startDate,message:"Registration is open."})):!t&&!s&&((g=e==null?void 0:e.signupAccess)==null?void 0:g.isEndDateRequired)&&((y=e==null?void 0:e.signupAccess)==null?void 0:y.endDate)?n.default.createElement(q,{title:"Registration ends in:"},n.default.createElement(N,{dateString:(E=e==null?void 0:e.signupAccess)==null?void 0:E.endDate,message:"Registration is closed."})):null}const L="https://apitest.hype.day";function F(e){return e.text().then(s=>{const l=s&&JSON.parse(s);if(!e.ok){const t=l&&l.message||e.statusText;return Promise.reject(t)}return l})}function P({appId:e,projectId:s,userId:l}){const t={method:"GET",headers:{"Content-Type":"application/json"}};return fetch(`${L}/getProject?`+new URLSearchParams({appid:e,userid:l||"",projectid:s}),t).then(F)}function _({appId:e,projectId:s,userId:l,returnUrl:t}){const i={method:"GET",headers:{"Content-Type":"application/json"}};return fetch("https://us-central1-hype-testing.cloudfunctions.net/tGetUrlForApp?"+new URLSearchParams({appid:e,userid:l,projectid:s,returnurl:t}),i).then(F)}function H({projectData:e,appId:s,userId:l}){var c,f,m;if(!((c=e==null?void 0:e.twitter)!=null&&c.enabled))return null;const{twitter:t,userInfo:i}=e,d=[];if(t!=null&&t.isAccountCreatedRequired){const r=n.default.createElement(n.default.Fragment,null,"Have an account created before"," ",n.default.createElement("strong",null,new Date((t==null?void 0:t.accountCreated)||"").toLocaleDateString()));d.push(r)}if(t!=null&&t.isFollowRequired){const r=(f=t==null?void 0:t.follow)==null?void 0:f.split(","),h=n.default.createElement(n.default.Fragment,null,"Follow these account(s):",n.default.createElement("ul",null,r==null?void 0:r.map(u=>n.default.createElement("li",{key:u},n.default.createElement("a",{href:`https://twitter.com/${u.trim()}`,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"@",u))))));d.push(h)}if(t!=null&&t.isMinFollowersRequired){const r=n.default.createElement(n.default.Fragment,null,"Have at least ",n.default.createElement("b",null,t.minFollowers," follower(s)"));d.push(r)}if(t!=null&&t.isRetweetRequired){const r=n.default.createElement(n.default.Fragment,null,"Retweet"," ",n.default.createElement("a",{href:t.retweetUrl,target:"_blank",rel:"noreferrer"},n.default.createElement("strong",null,"this tweet")));d.push(r)}const o=async()=>{if(!s||!l||!(e!=null&&e.id))return;const{url:r}=await _({appId:s,userId:l,projectId:e.id,returnUrl:window.location.href});window.location.assign(r)};return n.default.createElement(T,{title:"Twitter",onClick:o,info:d,rightText:(m=i==null?void 0:i.twitter)==null?void 0:m.username,buttonDisabled:!l})}const U={ethereum:"ETH",solana:"SOL",polygon:"MATIC",avalanche:"AVAX",flow:"FLOW"};function M({projectData:e}){if(!(e!=null&&e.wallet))return null;const{wallet:s}=e,l=[];if(s!=null&&s.isBalanceRequired){const t=n.default.createElement(n.default.Fragment,null,"Have at least",n.default.createElement("strong",null," "+s.balance+" "+U[e.chain]+" "),"in your wallet");l.push(t)}if(s!=null&&s.isNftRequired){const{nftCollection:t}=s,i=n.default.createElement(n.default.Fragment,null,"Hold an NFT from"," ",n.default.createElement("strong",null,n.default.createElement("a",{href:t==null?void 0:t.url,target:"_blank",rel:"noreferrer"},t==null?void 0:t.name)));l.push(i)}return n.default.createElement(T,{title:"Wallet",onClick:()=>console.log("wallet button clicked"),info:l,rightText:" "})}const x="";function O({appId:e,projectId:s,userId:l}){var o,c;const[t,i]=a.useState();a.useEffect(()=>{!s||P({appId:e,projectId:s,userId:l}).then(f=>i(f))},[e,s,l]);const d=()=>{var f;(f=t==null?void 0:t.userInfo)!=null&&f.registered||console.log("register button clicked")};return n.default.createElement("div",{className:"hypeday-wrapper"},n.default.createElement(C,{projectData:t}),n.default.createElement(M,{projectData:t}),n.default.createElement(H,{projectData:t,appId:e,userId:l}),n.default.createElement(v,{projectData:t,appId:e,userId:l}),n.default.createElement(k,{projectData:t}),n.default.createElement("button",{className:"hypeday-register-button",onClick:d},!t&&"Loading...",t&&((o=t==null?void 0:t.userInfo)==null?void 0:o.registered)&&"Registered",t&&!((c=t.userInfo)!=null&&c.registered)&&"Register"))}return O});
